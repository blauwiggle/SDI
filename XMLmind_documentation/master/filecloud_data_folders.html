<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>7.&nbsp;Setting up the data folders</title><link rel="stylesheet" type="text/css" href="html.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="index.html" title="Documentation &#34;Software Defined Infrastructure&#34; in summer term 2020 (Group 8)"><link rel="up" href="filecloud.html" title="Chapter&nbsp;5.&nbsp;File cloud"><link rel="prev" href="filecloud_installation.html" title="6.&nbsp;Nextcloud installation and configuration"><link rel="next" href="filecloud_memory_cache.html" title="8.&nbsp;Configuring the memory cache"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">7.&nbsp;Setting up the data folders</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="filecloud_installation.html"><img src="images/prev.svg" alt="Prev"></a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;5.&nbsp;File cloud</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="filecloud_memory_cache.html"><img src="images/next.svg" alt="Next"></a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="filecloud_data_folders"></a>7.&nbsp;Setting up the data folders</h2></div></div></div><p>We moved the data folder to the <code class="filename">var</code> directory and renamed it to <code class="filename">nc_data</code>:</p><pre class="screen">mv /var/www/nextcloud/data /var/nc_data</pre><p>Then we created a script to correctly set the folder permissions. We copied it from the <a class="link" href="https://help.nextcloud.com/t/complete-nc-installation-on-debian-9-stretch-and-manual-update/21881" target="_top">Nextcloud tutorial page</a>: </p><pre class="screen">vi /var/www/nc_perm.sh</pre><pre class="screen">#!/bin/bash
ncpath='/var/www/nextcloud'
ncdata='/var/nc_data'
htuser='www-data'
htgroup='www-data'
rootuser='root'

printf "Creating possible missing Directories\n"
mkdir -p $ncpath/data
mkdir -p $ncpath/updater

printf "chmod Files and Directories\n"
find ${ncpath} -type f -print0 | xargs -0 chmod 0640
find ${ncpath} -type d -print0 | xargs -0 chmod 0750
find ${ncdata} -type f -print0 | xargs -0 chmod 0640
find ${ncdata} -type d -print0 | xargs -0 chmod 0750

printf "chown Directories\n"
chown -R ${rootuser}:${htgroup} ${ncpath}
chown -R ${htuser}:${htgroup} ${ncpath}/apps/
chown -R ${htuser}:${htgroup} ${ncpath}/config/
chown -R ${htuser}:${htgroup} ${ncdata}/
chown -R ${htuser}:${htgroup} ${ncpath}/themes/
chown -R ${htuser}:${htgroup} ${ncpath}/updater/

chmod +x ${ncpath}/occ

printf "chmod/chown .htaccess\n"
if [ -f ${ncpath}/.htaccess ]
then
        chmod 0644 ${ncpath}/.htaccess
        chown ${rootuser}:${htgroup} ${ncpath}/.htaccess
fi
if [ -f ${ncdata}/.htaccess ]
then
        chmod 0644 ${ncdata}/.htaccess
        chown ${rootuser}:${htgroup} ${ncdata}/.htaccess
fi
## END SCRIPT</pre><p>Then we set the permissions so that we could execute the script and executed it: </p><pre class="screen">chmod 750 /var/www/nc_perm.sh
/var/www/nc_perm.sh</pre></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="filecloud_installation.html"><img src="images/prev.svg" alt="Prev"></a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="filecloud.html"><img src="images/up.svg" alt="Up"></a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="filecloud_memory_cache.html"><img src="images/next.svg" alt="Next"></a></td></tr><tr><td width="40%" align="left" valign="top">6.&nbsp;Nextcloud installation and configuration&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/home.svg" alt="Home"></a></td><td width="40%" align="right" valign="top">&nbsp;8.&nbsp;Configuring the memory cache</td></tr></table></div></body></html>